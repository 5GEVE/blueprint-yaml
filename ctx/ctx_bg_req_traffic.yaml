# ctx_bg_req_traffic.yaml
---
blueprintId: 'ctx_bg_req_traffic'
version: '1.0'
name: 'Context Blueprint Background Requests Traffic'
description: 'Context Blueprint to add artificial background requests traffic to a VSB.'
parameters:
  - parameterId: 'bg_clients'
    parameterName: 'Background Requests Traffic Number Of Clients'
    parameterType: 'number'
    parameterDescription: 'The number of clients generating background requests traffic.'
    applicabilityField: 'context'
  - parameterId: 'bg_spawn_rate'
    parameterName: 'Background Requests Traffic Spawn Rate Of Clients'
    parameterType: 'number'
    parameterDescription: 'The rate of clients spawning in clients per second.'
    applicabilityField: 'context'
  - parameterId: 'bg_client'
    parameterName: 'Background Requests Traffic Number Of Clients'
    parameterType: 'number'
    parameterDescription: 'The number of clients generating background requests traffic.'
    applicabilityField: 'context'
  - parameterId: 'bg_timeout'
    parameterName: 'Background Requests Traffic Timeout Period'
    parameterType: 'number'
    parameterDescription: 'The time period for the continuous requests generation in seconds.'
    applicabilityField: 'context'
  - parameterId: 'bg_client_behavior'
    parameterName: 'Background Requests Traffic Clients Behavior'
    parameterType: 'script' 
    # is 'script' a valid option? client behavior is defined in a python file that can be part of the VNF or provided as an input
    parameterDescription: 'The time period for the continuous requests generation in seconds.'
    applicabilityField: 'context'
atomicComponents:
  - componentId: 'Request_Generator'
    serversNumber: 1
    # componentName: 'Background Traffic Source'
    imagesUrls: ['/path/to/bg_req_gen.qcow']
    endPointsIds: ['CpReqGen']
    lifecycleOperations:
      instantiate: 'scripts/instantiate'
      terminate: 'scripts/terminate'
      update: 'scripts/update'
      heal: 'scripts/heal'
    # scalingRules: []
endPoints:
  - endPointId: 'CpReqGen'
    external: false
    management: false
    ranConnection: false
applicationMetrics:
  - metricId: 'number_of_requests'
    name: 'Number of requests generated'
    metricCollectionType: 'CUMULATIVE'
    unit: 'requests'
    interval: '1s'
    topic: '/app/number_of_requests'
  - metricId: 'number_of_fails'
    name: 'Number of requests failed'
    metricCollectionType: 'CUMULATIVE'
    unit: 'fails'
    interval: '1s'
    topic: '/app/fails'
  - metricId: 'average_response_time'
    name: 'Average response time of the generated requests'
    metricCollectionType: 'GAUGE'
    unit: 'ms'
    interval: '1s'
    topic: '/app/average_response_time'
  - metricId: 'minimum_response_time'
    name: 'Minimum response time of the generated requests'
    metricCollectionType: 'GAUGE'
    unit: 'ms'
    interval: '1s'
    topic: '/app/minimum_response_time'
  - metricId: 'maximum_response_time'
    name: 'Maximum response time of the generated requests'
    metricCollectionType: 'GAUGE'
    unit: 'ms'
    interval: '1s'
    topic: '/app/maximum_response_time'
  - metricId: 'median_response_time'
    name: 'Median response time of the generated requests'
    metricCollectionType: 'GAUGE'
    unit: 'ms'
    interval: '1s'
    topic: '/app/median_response_time'
  - metricId: 'rate'
    name: 'Requests generated per second'
    metricCollectionType: 'GAUGE'
    unit: 'reqs/sec'
    interval: '1s'
    topic: '/app/rate'
compatibleSites:
  - GREECE-OTE